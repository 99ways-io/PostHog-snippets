<script>
// Variation definition
const testSlug = 'YOUR_FEATURE_FLAG_KEY';

const variations = {
  'control': [], // ALWAYS keep the control key as 'control'
  'test_group_1': [
    {
      selector: '#original-element',
      updates: {style: {display: 'none'}}
    },
    {
      selector: '#variant-one-element',
      updates: {style: {display: 'block'}}
    }
  ],
  'test_group_2': [
    {
      selector: '#original-element',
      updates: {style: {display: 'none'}}
    },
    {
      selector: '#variant-two-element',
      updates: {style: {display: 'block'}}
    }
  ]
};



// Utility functions
const applyUpdates = (selector, updates) => {
  const elements = document.querySelectorAll(selector);
  elements.forEach((element) => {
    Object.entries(updates).forEach(([key, value]) => {
      if (typeof value === 'object' && !Array.isArray(value)) {
        Object.entries(value).forEach(([nestedKey, nestedValue]) => {
          element[key][nestedKey] = nestedValue;
        });
      } else if (['innerText','innerHTML'].includes(key)) {
        element[key]= value;
        console.log(element);
        console.log(key,value);
      } else {
      element.setAttribute(key, value);
        console.log(element);
        console.log(key,value);
      }
    });
  });
};
const applyVariantConfig = (variations, variant) => {
  const config = variations[variant];
  config.forEach(({ selector, updates }) => {
    applyUpdates(selector, updates);
  });
  console.log(variant," activated");
};
// Determine and apply visibility of variants based on URL parameter or feature flag
const evaluateTestGroup = (variations, testSlug) => {
  let groupValue = getQueryParamByKey(testSlug);
  if (groupValue) {
    applyVariantConfig(variations, groupValue);
  } else {
    posthog.onFeatureFlags(() => {
      let groupValue = posthog.getFeatureFlag(testSlug);
      if (variations.hasOwnProperty(groupValue)) {
        applyVariantConfig(variations, groupValue);
      } else {
        console.log("Test not started yet, showing control.");
        applyVariantConfig(variations, 'control');
      }
    });
  }
};
  
evaluateTestGroup(variations, testSlug);

</script> 
